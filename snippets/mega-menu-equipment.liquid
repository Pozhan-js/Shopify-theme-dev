<!-- Equipment Mega Menu Snippet - 获取产品系列和产品展示名称 -->
<div class="mega-dropdown-menu">
  <div class="mega-menu-grid">
    <div class="mega-menu-column">
      <!-- 动态获取产品系列 -->
      {% assign collections = collections | where: 'published', true %}
      {% assign collection_count = 0 %}
      {% for collection in collections limit: 5 %}
        {% if collection_count < 5 %}
          <div class="mega-menu-category">
            <h3>{{ collection.title }}</h3>
            <ul>
              {% for product in collection.products limit: 6 %}
                <li><a href="{{ product.url }}">{{ product.title }}</a></li>
              {% endfor %}
              {% if collection.products.size == 0 %}
                <li><a href="{{ collection.url }}">View {{ collection.title }}</a></li>
              {% endif %}
            </ul>
          </div>
          {% assign collection_count = collection_count | plus: 1 %}
        {% endif %}
      {% endfor %}
      
      <!-- 如果没有产品系列，显示默认内容 -->
      {% if collections.size == 0 %}
        <div class="mega-menu-category">
          <h3>{{ section.settings.equipment_cat1_title | default: 'Reformer' }}</h3>
          <ul>
            {% for i in (1..6) %}
              {% assign item_title = 'equipment_cat1_item' | append: i | append: '_title' %}
              {% assign item_url = 'equipment_cat1_item' | append: i | append: '_url' %}
              {% if section.settings[item_title] != blank %}
                <li><a href="{{ section.settings[item_url] | default: '#' }}">{{ section.settings[item_title] }}</a></li>
              {% endif %}
            {% endfor %}
            {% if section.settings.equipment_cat1_item1_title == blank %}
              <li><a href="#">Pilates Reformer XSRF100</a></li>
              <li><a href="#">Aluminum Reformer XSRF04</a></li>
              <li><a href="#">Aluminum Reformer XSRF07</a></li>
              <li><a href="#">Classic Aluminum Reformer XSCAR</a></li>
            {% endif %}
          </ul>
        </div>
        <div class="mega-menu-category">
          <h3>{{ section.settings.equipment_cat2_title | default: 'Pilates Chair' }}</h3>
          <ul>
            {% for i in (1..6) %}
              {% assign item_title = 'equipment_cat2_item' | append: i | append: '_title' %}
              {% assign item_url = 'equipment_cat2_item' | append: i | append: '_url' %}
              {% if section.settings[item_title] != blank %}
                <li><a href="{{ section.settings[item_url] | default: '#' }}">{{ section.settings[item_title] }}</a></li>
              {% endif %}
            {% endfor %}
            {% if section.settings.equipment_cat2_item1_title == blank %}
              <li><a href="#">Basic Pilates Chair XSCC29</a></li>
              <li><a href="#">Pilates Chair Wooden Base XSCC01</a></li>
              <li><a href="#">Pro Pilates Wunda Chair XSCC32</a></li>
            {% endif %}
          </ul>
        </div>
        <div class="mega-menu-category">
          <h3>{{ section.settings.equipment_cat3_title | default: 'Accessories' }}</h3>
          <ul>
            {% for i in (1..6) %}
              {% assign item_title = 'equipment_cat3_item' | append: i | append: '_title' %}
              {% assign item_url = 'equipment_cat3_item' | append: i | append: '_url' %}
              {% if section.settings[item_title] != blank %}
                <li><a href="{{ section.settings[item_url] | default: '#' }}">{{ section.settings[item_title] }}</a></li>
              {% endif %}
            {% endfor %}
            {% if section.settings.equipment_cat3_item1_title == blank %}
              <li><a href="#">Padded Wedge XSWD49</a></li>
              <li><a href="#">Pilates Balance Cushion XSAC03</a></li>
              <li><a href="#">Pilates Ring XSAC04</a></li>
              <li><a href="#">Pilates Ball XSAC05</a></li>
            {% endif %}
          </ul>
        </div>
      {% endif %}
    </div>
    <div class="mega-menu-column">
      <div class="mega-menu-cta">
        {% if section.settings.equipment_image %}
          <img src="{{ section.settings.equipment_image | img_url: '800x1200' }}" alt="{{ section.settings.equipment_image_alt | default: 'Pilates Equipment' }}" />
        {% else %}
          <img src="https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=800&h=1200&fit=crop&crop=center" alt="Pilates Equipment" />
        {% endif %}
      </div>
    </div>
  </div>
  <div class="mega-menu-footer">
    {% if section.settings.contactfootericon %}
      <div class="mega-menu-footer-icon">
        <img src="{{ section.settings.contactfootericon | img_url: '44x44' }}" alt="Contact Icon">
      </div>
    {% endif %}
    <span>{{ section.settings.equipment_footer_text | default: 'CONTACT US' }}</span>
  </div>
</div>
