{%- liquid
  assign image_position = section.settings.image_position
-%}

{% schema %}
{
  "name": "图文区块",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "标题",
      "default": "区块标题"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "内容",
      "default": "<p>在这里输入您的富文本内容</p>"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "图片"
    },
    {
      "type": "select",
      "id": "image_position",
      "label": "图片位置",
      "options": [
        {
          "value": "left",
          "label": "左侧"
        },
        {
          "value": "right",
          "label": "右侧"
        }
      ],
      "default": "right"
    },
    {
      "type": "range",
      "id": "text_width",
      "min": 30,
      "max": 70,
      "step": 5,
      "unit": "%",
      "label": "文本区域宽度",
      "default": 50
    }
  ],
  "blocks": [
    {
      "type": "button",
      "name": "按钮",
      "settings": [
        {
          "type": "text",
          "id": "button_text",
          "label": "按钮文字",
          "default": "点击这里"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "按钮链接"
        },
        {
          "type": "color",
          "id": "button_text_color",
          "label": "文字颜色",
          "default": "#000000"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "图文区块"
    }
  ]
}
{% endschema %}

<style>
  .image-text-container {
    display: flex;
    align-items: center;
    gap: 40px;
    padding: 40px 0;
  }

  .text-content {
    flex: 1;
    max-width: {{ section.settings.text_width }}%;
  }

  .image-content {
    flex: 1;
  }

  .image-content img {
    width: 100%;
    height: auto;
    border-radius: 8px;
  }

  .section-heading {
    font-size: 2rem;
    margin-bottom: 20px;
  }

  .custom-button {
    display: inline-block;
    padding: 8px 16px;
    margin-top: 20px;
    background: transparent;
    border: 1px solid currentColor;
    border-radius: 4px;
    text-decoration: none;
    transition: opacity 0.3s ease;
  }

  .custom-button:hover {
    opacity: 0.8;
  }

  @media screen and (max-width: 749px) {
    .image-text-container {
      flex-direction: column;
      gap: 20px;
    }

    .text-content,
    .image-content {
      max-width: 100%;
      width: 100%;
    }

    {% if section.settings.image_position == 'left' %}
      .image-text-container {
        flex-direction: column-reverse;
      }
    {% endif %}
  }
</style>

<div
  class="image-text-container"
  style="flex-direction: {% if section.settings.image_position == 'left' %}row-reverse{% else %}row{% endif %}"
>
  <div class="text-content">
    <h2 class="section-heading">{{ section.settings.heading }}</h2>
    <div class="rte">
      {{ section.settings.text }}
    </div>
    
    {% for block in section.blocks %}
      {% if block.type == 'button' %}
        <a 
          href="{{ block.settings.button_link }}" 
          class="custom-button" 
          style="color: {{ block.settings.button_text_color }};"
          {{ block.shopify_attributes }}
        >
          {{ block.settings.button_text }}
        </a>
      {% endif %}
    {% endfor %}
  </div>

  <div class="image-content">
    {%- if section.settings.image != blank -%}
      <img
        src="{{ section.settings.image | img_url: '800x' }}"
        alt="{{ section.settings.heading | escape }}"
        loading="lazy"
        width="800"
        height="{{ 800 | divided_by: section.settings.image.aspect_ratio | round }}"
      >
    {%- endif -%}
  </div>
</div>
