{% comment %}
  Custom sidebar menu - fixed on left side
  Usage: {% section 'custom-sidebar' %}
{% endcomment %}

{%- liquid
  assign dropdown_menu = section.settings.dropdown_menu | default: nil
  assign mega_menu = section.settings.mega_menu | default: nil
  
  if dropdown_menu == blank and mega_menu == blank
    assign show_default = true
  endif
  
  if mega_menu == blank and dropdown_menu != blank
    assign mega_menu = dropdown_menu
  endif
-%}

{% if show_default %}
  {% comment %} Default menu fallback {% endcomment %}
  {% assign dropdown_menu = linklists['main-menu'] %}
{% endif %}

<style>
  .custom-sidebar {
    position: fixed;
    left: 0;
    top: var(--header-height, 80px);
    width: 280px;
    height: calc(100vh - var(--header-height, 80px));
    background: #fff;
    z-index: 99;
    box-shadow: 2px 0 5px rgba(0,0,0,0.1);
    overflow-y: auto;
  }

  @media screen and (max-width: 749px) {
    .custom-sidebar {
      width: 100%;
      position: static;
      height: auto;
    }
  }
</style>

<div class="custom-sidebar">
  {% comment %} Debug info {% endcomment %}
  <div style="display:none">
    section.settings: {{ section.settings | json }}<br>
    dropdown_menu: {{ dropdown_menu | json }}<br>
    mega_menu: {{ mega_menu | json }}<br>
    linklists: {{ linklists | json }}
  </div>

  {%- if dropdown_menu != blank -%}
    {% render 'vertical-dropdown-menu' %}
  {%- endif -%}

  {%- if mega_menu != blank -%}
    {% render 'vertical-mega-menu' %}
  {%- endif -%}

  {%- if dropdown_menu == blank and mega_menu == blank -%}
    <div class="sidebar-warning">
      Please select menus in theme editor
    </div>
  {%- endif -%}
</div>

{% schema %}
{
  "name": "Custom Sidebar",
  "settings": [
    {
      "type": "link_list",
      "id": "dropdown_menu",
      "label": "Dropdown Menu"
    },
    {
      "type": "link_list",
      "id": "mega_menu",
      "label": "Mega Menu"
    }
  ],
  "presets": [
    {
      "name": "Custom Sidebar"
    }
  ]
}
{% endschema %}
