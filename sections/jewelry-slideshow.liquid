<!-- 珠宝轮播图 - 支持后台编辑版 -->
<div class="jewelry-slideshow-container" style="height: {% if section.settings.slide_height == 'large' %}500px{% elsif section.settings.slide_height == 'medium' %}400px{% else %}300px{% endif %};">
    <div class="jewelry-slideshow">
        <div class="slideshow-wrapper">
            {% if section.blocks.size > 0 %}
                {% for block in section.blocks %}
                    {% if block.type == 'slide' %}
                        <div class="slide {% if forloop.first %}active{% endif %}" data-slide-index="{{ forloop.index0 }}">
                            {% if block.settings.image %}
                                <img src="{{ block.settings.image | image_url: width: 1920, height: 1080, crop: 'center' }}" 
                                     alt="{{ block.settings.title | escape }}">
                            {% else %}
                                <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
                            {% endif %}
                            <div class="slide-content" style="text-align: {{ block.settings.text_alignment }};">
                                <h2 style="color: {{ block.settings.title_color }}; font-size: {{ block.settings.title_size }}px;">{{ block.settings.title | default: '珠宝系列' }}</h2>
                                <p style="color: {{ block.settings.text_color }}; font-size: {{ block.settings.text_size }}px;">{{ block.settings.description | default: '精美珠宝，匠心打造' }}</p>
                                {% if block.settings.button_text != blank %}
                                    <a href="{{ block.settings.button_link }}" 
                                       class="btn" 
                                       style="background-color: {{ block.settings.button_bg_color }}; 
                                              color: {{ block.settings.button_text_color }}; 
                                              border-radius: {{ block.settings.button_border_radius }}px;">
                                        {{ block.settings.button_text }}
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            {% else %}
                <!-- 默认显示内容，当没有配置数据时 -->
                <div class="slide active">
                    <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
                    <div class="slide-content" style="text-align: center;">
                        <h2 style="color: #ffffff; font-size: 48px;">钻石系列</h2>
                        <p style="color: #ffffff; font-size: 20px;">永恒之美的象征，每一件都是艺术品</p>
                        <a href="/collections/all" class="btn" style="background-color: rgba(255, 255, 255, 0.9); color: #333333; border-radius: 30px;">探索系列</a>
                    </div>
                </div>
                <div class="slide">
                    <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"></div>
                    <div class="slide-content" style="text-align: center;">
                        <h2 style="color: #ffffff; font-size: 48px;">珍珠系列</h2>
                        <p style="color: #ffffff; font-size: 20px;">优雅与纯洁的化身，经典永不过时</p>
                        <a href="/collections/all" class="btn" style="background-color: rgba(255, 255, 255, 0.9); color: #333333; border-radius: 30px;">查看详情</a>
                    </div>
                </div>
                <div class="slide">
                    <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);"></div>
                    <div class="slide-content" style="text-align: center;">
                        <h2 style="color: #ffffff; font-size: 48px;">彩宝系列</h2>
                        <p style="color: #ffffff; font-size: 20px;">绚丽色彩的艺术，大自然的馈赠</p>
                        <a href="/collections/all" class="btn" style="background-color: rgba(255, 255, 255, 0.9); color: #333333; border-radius: 30px;">立即选购</a>
                    </div>
                </div>
            {% endif %}
        </div>
        
        <!-- 导航箭头 -->
        {% if section.blocks.size > 1 or section.blocks.size == 0 %}
            <div class="nav-arrows">
                <button class="arrow prev" onclick="changeSlide(-1)">❮</button>
                <button class="arrow next" onclick="changeSlide(1)">❯</button>
            </div>
            
            <!-- 小圆点导航 -->
            <div class="dots-container">
                {% if section.blocks.size > 0 %}
                    {% for block in section.blocks %}
                        {% if block.type == 'slide' %}
                            <span class="dot {% if forloop.first %}active{% endif %}" 
                                  onclick="currentSlide({{ forloop.index }})"></span>
                        {% endif %}
                    {% endfor %}
                {% else %}
                    <span class="dot active" onclick="currentSlide(1)"></span>
                    <span class="dot" onclick="currentSlide(2)"></span>
                    <span class="dot" onclick="currentSlide(3)"></span>
                {% endif %}
            </div>
        {% endif %}
    </div>
</div>

<style>
.jewelry-slideshow-container {
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    position: relative;
    overflow: hidden;
}

.jewelry-slideshow {
    position: relative;
    width: 100%;
    height: 100%;
}

.slideshow-wrapper {
    position: relative;
    width: 100%;
    height: 100%;
}

.slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    transition: opacity 0.5s ease-in-out;
}

.slide.active {
    opacity: 1;
    z-index: 1;
}

.slide img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.slide-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    background: transparent;
    padding: 0;
    border-radius: 0;
    backdrop-filter: none;
    z-index: 2;
}

.slide-content h2 {
    margin-bottom: 20px;
    font-weight: 300;
    line-height: 1.2;
}

.slide-content p {
    margin-bottom: 30px;
    line-height: 1.5;
}

.btn {
    display: inline-block;
    padding: 15px 40px;
    text-decoration: none;
    font-size: 16px;
    transition: all 0.3s ease;
    border: none;
    cursor: pointer;
}

.btn:hover {
    transform: translateY(-2px);
    opacity: 0.9;
}

/* 导航箭头 */
.nav-arrows {
    position: absolute;
    top: 50%;
    width: 100%;
    transform: translateY(-50%);
    z-index: 2;
}

.arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0, 0, 0, 0.3);
    color: white;
    border: none;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 20px;
    transition: background 0.3s ease;
    z-index: 3;
}

.arrow:hover {
    background: rgba(0, 0, 0, 0.6);
}

.prev {
    left: 20px;
}

.next {
    right: 20px;
}

/* 小圆点导航 */
.dots-container {
    position: absolute;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 10px;
    z-index: 2;
}

.dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.5);
    cursor: pointer;
    transition: background 0.3s ease;
}

.dot.active {
    background: white;
}

/* 响应式设计 */
@media screen and (max-width: 749px) {
    .jewelry-slideshow-container {
        height: 60vh !important;
    }
    
    .slide-content h2 {
        font-size: 28px !important;
    }
    
    .slide-content p {
        font-size: 16px !important;
    }
    
    .arrow {
        width: 40px;
        height: 40px;
        font-size: 16px;
    }
    
    .prev {
        left: 10px;
    }
    
    .next {
        right: 10px;
    }
    
    .btn {
        padding: 12px 30px;
        font-size: 14px;
    }
}
</style>

<script>
let currentSlideIndex = 0;
let autoRotateInterval;
let slides, dots, totalSlides;

// 初始化轮播图
function initSlideshow() {
    slides = document.querySelectorAll('.slide');
    dots = document.querySelectorAll('.dot');
    totalSlides = slides.length;
    
    if (totalSlides > 0) {
        showSlide(currentSlideIndex);
        
        {% if section.settings.auto_rotate %}
            {% if section.blocks.size > 1 or section.blocks.size == 0 %}
                autoRotateInterval = setInterval(() => {
                    changeSlide(1);
                }, {{ section.settings.change_slides_speed | times: 1000 }});
            {% endif %}
        {% endif %}
    }
}

// 显示指定幻灯片
function showSlide(index) {
    if (!slides || slides.length === 0) return;
    
    slides.forEach((slide, i) => {
        slide.classList.toggle('active', i === index);
    });
    
    if (dots && dots.length > 0) {
        dots.forEach((dot, i) => {
            dot.classList.toggle('active', i === index);
        });
    }
}

// 切换幻灯片
function changeSlide(direction) {
    if (!slides || slides.length <= 1) return;
    
    currentSlideIndex += direction;
    
    if (currentSlideIndex >= totalSlides) {
        currentSlideIndex = 0;
    } else if (currentSlideIndex < 0) {
        currentSlideIndex = totalSlides - 1;
    }
    
    showSlide(currentSlideIndex);
}

// 跳转到指定幻灯片
function currentSlide(index) {
    if (!slides || slides.length <= 1) return;
    
    currentSlideIndex = index - 1;
    showSlide(currentSlideIndex);
    
    // 重置自动轮播计时器
    {% if section.settings.auto_rotate %}
        clearInterval(autoRotateInterval);
        {% if section.blocks.size > 1 or section.blocks.size == 0 %}
            autoRotateInterval = setInterval(() => {
                changeSlide(1);
            }, {{ section.settings.change_slides_speed | times: 1000 }});
        {% endif %}
    {% endif %}
}

// 页面加载完成后初始化
document.addEventListener('DOMContentLoaded', initSlideshow);

// 鼠标悬停时暂停自动轮播
const slideshowContainer = document.querySelector('.jewelry-slideshow-container');
if (slideshowContainer) {
    slideshowContainer.addEventListener('mouseenter', () => {
        clearInterval(autoRotateInterval);
    });
    
    slideshowContainer.addEventListener('mouseleave', () => {
        {% if section.settings.auto_rotate %}
            {% if section.blocks.size > 1 or section.blocks.size == 0 %}
                autoRotateInterval = setInterval(() => {
                    changeSlide(1);
                }, {{ section.settings.change_slides_speed | times: 1000 }});
            {% endif %}
        {% endif %}
    });
}
</script>

{% schema %}
{
  "name": "珠宝轮播图",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "select",
      "id": "slide_height",
      "options": [
        {
          "value": "large",
          "label": "大 (100vh)"
        },
        {
          "value": "medium",
          "label": "中 (70vh)"
        },
        {
          "value": "small",
          "label": "小 (50vh)"
        }
      ],
      "default": "large",
      "label": "轮播图高度"
    },
    {
      "type": "checkbox",
      "id": "auto_rotate",
      "label": "自动轮播",
      "default": true
    },
    {
      "type": "range",
      "id": "change_slides_speed",
      "min": 3,
      "max": 9,
      "step": 1,
      "unit": "秒",
      "label": "切换速度",
      "default": 5
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "轮播图幻灯片",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "背景图片"
        },
        {
          "type": "text",
          "id": "title",
          "label": "标题",
          "default": "钻石系列"
        },
        {
          "type": "select",
          "id": "title_size",
          "options": [
            {
              "value": "32",
              "label": "小"
            },
            {
              "value": "48",
              "label": "中"
            },
            {
              "value": "64",
              "label": "大"
            }
          ],
          "default": "48",
          "label": "标题大小"
        },
        {
          "type": "color",
          "id": "title_color",
          "label": "标题颜色",
          "default": "#ffffff"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "描述文字",
          "default": "永恒之美的象征，每一件都是艺术品"
        },
        {
          "type": "select",
          "id": "text_size",
          "options": [
            {
              "value": "16",
              "label": "小"
            },
            {
              "value": "20",
              "label": "中"
            },
            {
              "value": "24",
              "label": "大"
            }
          ],
          "default": "20",
          "label": "文字大小"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "文字颜色",
          "default": "#ffffff"
        },
        {
          "type": "select",
          "id": "text_alignment",
          "options": [
            {
              "value": "left",
              "label": "左对齐"
            },
            {
              "value": "center",
              "label": "居中"
            },
            {
              "value": "right",
              "label": "右对齐"
            }
          ],
          "default": "center",
          "label": "文字对齐方式"
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "按钮文字",
          "default": "探索系列"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "按钮链接"
        },
        {
          "type": "color",
          "id": "button_bg_color",
          "label": "按钮背景颜色",
          "default": "rgba(255, 255, 255, 0.9)"
        },
        {
          "type": "color",
          "id": "button_text_color",
          "label": "按钮文字颜色",
          "default": "#333333"
        },
        {
          "type": "range",
          "id": "button_border_radius",
          "min": 0,
          "max": 50,
          "step": 1,
          "unit": "px",
          "label": "按钮圆角",
          "default": 30
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "珠宝轮播图",
      "settings": {
        "slide_height": "large",
        "auto_rotate": true,
        "change_slides_speed": 5
      },
      "blocks": [
        {
          "type": "slide",
          "settings": {
            "title": "钻石系列",
            "description": "永恒之美的象征，每一件都是艺术品",
            "button_text": "探索系列",
            "button_link": "/collections/all"
          }
        },
        {
          "type": "slide",
          "settings": {
            "title": "珍珠系列",
            "description": "优雅与纯洁的化身，经典永不过时",
            "button_text": "查看详情",
            "button_link": "/collections/all"
          }
        },
        {
          "type": "slide",
          "settings": {
            "title": "彩宝系列",
            "description": "绚丽色彩的艺术，大自然的馈赠",
            "button_text": "立即选购",
            "button_link": "/collections/all"
          }
        }
      ]
    }
  ]
}
{% endschema %}
